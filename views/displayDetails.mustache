<head>
    {{>header}}

    <style>
        .update-popup {
            display: none;
        }

        .sidebar {
            width: 30%;
            padding: 20px;
            color: black;
        }

        .sidebar ul {
            list-style: none;
            padding: 0;
            margin-top: 40px;
        }

        .sidebar a {
            text-decoration: none;
            color: black;
            padding: 10px;
            margin-bottom: 10px;
        }

        .sidebar a i {
            margin-right: 10px;
        }

        .content-sections {
            width: 70%;
            padding: 20px;
        }

        .scrollable-section {
            max-height: 300px;
            overflow-y: auto;
            background-color: white;
            padding: 20px;
            margin-bottom: 20px;
            border: 1px solid #C3C3C3;
        }
    </style>

    <!-- Bootstrap CSS -->
    <link rel="stylesheet" href="path-to-bootstrap/bootstrap.min.css">

    <!-- Bootstrap JavaScript and jQuery -->
    <script src="path-to-jquery/jquery.min.js"></script>
    <script src="path-to-bootstrap/bootstrap.min.js"></script>

</head>

<body style="margin: 0; padding: 0; box-sizing: border-box; height: 100vh;">

    <div class="container-fluid" style="height: 100%;">
        <h1>Welcome, Admin</h1>

        <div class="d-flex">
            <!-- Sidebar -->
            <div class="sidebar">
                <ul class="list-unstyled">
                    <li class="mt-4 p-2"><a href="#"><i class="bi bi-person-fill" style="font-size: 24px;"></i>Admin</a></li>
                    <li class="mt-4 p-2"><a href="/admin/dashboard"><i class="bi bi-speedometer" style="font-size: 24px;"></i>Dashboard</a></li>
                    <li class="mt-4 p-2"><a href="/admin_dashboard"><i class="bi bi-plus-square-fill" style="font-size: 24px;"></i>Add Program/Mentor Opportunities</a></li>
                    <li class="mt-4 p-2"><a href="#"><i class="bi bi-gear-fill" style="font-size: 24px;"></i>Settings</a></li>
                    <li class="mt-4 p-2"><a href="/students/logout"><i class="bi bi-box-arrow-left" style="font-size: 24px;"></i>Logout</a></li>
                </ul>
            </div>

            <!-- Content Sections -->
            <div class="content-sections">
                <!-- Section One - Student Data -->
                <h2 style="color: #E1658B;">Student Data</h2>
                <section class="scrollable-section pt-2 pb-2">
                    <table class="table table-bordered table-striped scrollable-section">
                        <thead>
                            <tr>
                                <th>First Name</th>
                                <th>Last Name</th>
                                <th>Email</th>
                            </tr>
                        </thead>
                        <tbody>
                            {{#students}}
                            <tr>
                                <td>{{firstname}}</td>
                                <td>{{lastname}}</td>
                                <td>{{email}}</td>
                            </tr>
                            {{/students}}
                        </tbody>
                    </table>
                </section>

                <!-- Section Two - Coaches Data -->
                <h2 style="color: #E1658B;">Coaches Data</h2>
                <section class="scrollable-section pt-2 pb-2">
                    <table class="table table-bordered table-striped scrollable-section">
                        <thead>
                            <tr>
                                <th>Name</th>
                                <th>Email</th>
                                <th>Mentorship/Program</th>
                                <th>Qualification</th>
                            </tr>
                        </thead>
                        <tbody id="coachesTableBody">
                            {{#coaches}}
                            <tr>
                                <td>{{coachName}}</td>
                                <td>{{coachEmail}}</td>
                                <td>{{coachProgram}}</td>
                                <td>{{coachQualification}}</td>
                            </tr>
                            {{/coaches}}
                        </tbody>
                    </table>
                </section>

                <!-- Section Three - Browse All Opportunities -->
                <section id="browseOpportunities">
                    <div class="d-flex justify-content-between align-items-center">
                        <h2 style="color: #E1658B;">Browse All Opportunities</h2>

                        <form method="POST" action="/students/searchByCode" class="form-inline" onsubmit="return searchProgram()">
                            <div class="input-group">
                                <input type="text" name="programCode" class="form-control" placeholder="Search Programs" style="border-radius: 0;">
                                <div class="input-group-append">
                                    <button type="submit" class="btn btn-dark" style="border-radius: 0; background-color: white; color: black; border: none; width: 120px; margin-left: 10px;">Find</button>
                                </div>
                            </div>
                        </form>
                    </div>

                    <div class="scrollable-section">
                        <table class="table table-bordered table-striped" id="browseOpportunitiesTable">
                            <thead>
                                <tr>
                                    <th style="display: none;">_id</th>
                                    <th>Program Code</th>
                                    <th>Mentorship Opportunity Name</th>
                                    <th>Mentor/Coach</th>
                                    <th>Duration</th>
                                </tr>
                            </thead>
                            <tbody id="browseOpportunitiesTableBody">
                                {{#opportunities}}
                                <tr>
                                    <td style="display: none;">{{programId}}</td>
                                    <td>{{programCode}}</td>
                                    <td>{{opportunityName}}</td>
                                    <td>{{mentorCoach}}</td>
                                    <td>{{duration}}</td>
                                    <td>
                                        <button class="btn btn-light" style="" onclick="openUpdateForm('{{programId}}')">Update</button>
                                        <button class="btn btn-light" onclick="deleteProgram('{{programId}}')">Delete</button>
                                    </td>
                                </tr>
                                {{/opportunities}}
                            </tbody>
                        </table>
                    </div>
                </section>
            </div>
        </div>
    </div>




    <!-- Modal for Deletion Confirmation -->
    <div class="modal" id="deleteModal">
        <!-- Modal content here -->
    </div>






    <script>

    // Search Results
    function searchProgram() {
        const searchInput = document.getElementById('searchInput').value.toLowerCase();
        const browseOpportunitiesTable = document.getElementById('browseOpportunitiesTable');
        const browseOpportunitiesRows = browseOpportunitiesTable.getElementsByTagName('tbody')[0].getElementsByTagName('tr');

        // Hide all rows in browseOpportunitiesTable
        for (let row of browseOpportunitiesRows) {
            row.style.display = 'none';
        }

        // Find and display matching rows in browseOpportunitiesTable
        for (let row of browseOpportunitiesRows) {
            const programName = row.getElementsByTagName('td')[1].textContent.toLowerCase();
            if (programName.includes(searchInput)) {
                row.style.display = '';
            }
        }

        return false; // Prevent the form from submitting
    }
    // End of Search Results

    function openUpdateForm(programCode) {
    // Implement logic to open the update form, e.g., show a modal with a form
    // You can use the programId to fetch program details and populate the form
    // Here, I'm redirecting to the updateProgram route with the programId
    window.location.href = `/students/updateForm?programId=${programId}`;
    }

   async function deleteProgram(programCode) {
    const confirmation = confirm('Are you sure you want to delete this program?');
    if (!confirmation) {
        return;
    }

    try {
        const response = await fetch('/students/removeProgram', {
            method: 'POST',
            headers: {
                'Content-Type': 'application/json'
            },
            body: JSON.stringify({ programCode: programCode.trim() })
        });

        if (response.ok) {
            alert('Program deleted successfully');
            window.location.reload();
        } else {
            console.error('Error:', await response.text());
        }
    } catch (error) {
        console.error('Error:', error);
    }
}




</script>


</body>
